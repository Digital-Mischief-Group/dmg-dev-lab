import { Box } from '@mui/system';
import { motion, useMotionValue, animate, useTransform } from 'framer-motion';

export interface FingerprintScanProps {
  duration?: number;
  onComplete?: () => void;
}

const FingerprintScan = (props: FingerprintScanProps) => {
  const { duration = 3, onComplete } = props;
  const progress = useMotionValue(0);
  const pathLength = useTransform(progress, [0, 1], [80, 0]);

  const handleStart = () => {
    const animation = animate(progress, 1, {
      duration,
      ease: 'linear',
      onComplete,
    });

    const handleEnd = () => {
      animation.stop();
      animate(progress, 0, { duration: 0.35 });
    };

    window.addEventListener('mouseup', handleEnd, { once: true });
    window.addEventListener('touchend', handleEnd, { once: true });
    window.addEventListener('touchcancel', handleEnd, { once: true });
  };

  return (
    <Box>
      <Box
        sx={{
          width: 190,
          height: 190,
          borderRadius: '50%',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          position: 'relative',
          touchAction: 'none',
        }}
      >
        <Box
          component={motion.svg}
          onMouseDown={handleStart}
          onTouchStart={handleStart}
          onTouchMove={e => e.preventDefault()}
          width="120px"
          height="120px"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 164 164"
          sx={{
            cursor: 'pointer',
            WebkitTapHighlightColor: 'transparent',
            WebkitTouchCallout: 'none',
            WebkitUserSelect: 'none',
            userSelect: 'none',
          }}
        >
          <path
            d="M78.99 70.384c6.128-1.642 12.427 1.994 14.068 8.122a179.609 179.609 0 0 1 4.733 24.151m-91.563 8.777a87.148 87.148 0 0 0-1.933-9.144 82.29 82.29 0 0 1-.597-2.367m80.861-7.248a169.016 169.016 0 0 0-2.596-11.196m.737 83.493a166.01 166.01 0 0 0 2.082-9.463m1.014-5.935a165.476 165.476 0 0 0-.156-50.796m3.04 65.929a171.42 171.42 0 0 0 3.707-21.21m-4.51-62.116c-.12-.463-.242-.926-.366-1.388a5.743 5.743 0 0 0-11.096 2.973 161.908 161.908 0 0 1 4.794 26.513m11.731 28.073c1.251-16.583.101-33.598-3.713-50.587m-12.402 77.797a159.741 159.741 0 0 0 4.842-49.311m-10.6 48.624c.515-1.949.993-3.911 1.433-5.884m1.108-5.434a153.991 153.991 0 0 0 1.272-48.123m-.905-6a157.03 157.03 0 0 0-3.107-14.182 11.48 11.48 0 0 1 2.778-10.899m21.083 90.519a177.255 177.255 0 0 0 2.664-14.383m.73-5.796a176.735 176.735 0 0 0 .323-35.168m2.452 54.046a182.553 182.553 0 0 0 3.914-31.968m.102-6.27c-.014-15.691-2.054-31.638-6.308-47.514a17.15 17.15 0 0 0-5.496-8.68M88.3 65.455a17.153 17.153 0 0 0-10.797-.62c-8.725 2.338-14.083 10.969-12.499 19.7m.386 78.533a148.503 148.503 0 0 0 4.893-31.487m.16-6.137a149.259 149.259 0 0 0-4.101-35.47m-6.501 71.608a143.02 143.02 0 0 0 3.746-19.139m.648-6.268c1.292-15.957-.083-32.402-4.464-48.751a22.867 22.867 0 0 1 .398-13.226m2.799-5.644a22.884 22.884 0 0 1 13.048-9.267c9.08-2.433 18.346.928 23.875 7.817m3.004 4.9a23.16 23.16 0 0 1 1.258 3.528 192.094 192.094 0 0 1 3.225 14.15m-.275 71.426c.215-1.094.421-2.189.617-3.288m1.027-6.369a188.324 188.324 0 0 0-.342-55.801m4.97 63.182a193.99 193.99 0 0 0 1.976-13.956m-5.176-69.025c-.155-.602-.313-1.204-.474-1.806-2.261-8.436-8.053-14.984-15.359-18.48m21.556 83.118c1.351-18.682.014-37.84-4.305-56.969M88.679 53.553a28.59 28.59 0 0 0-14.148.187c-12.36 3.312-20.667 14.203-21.258 26.333m.3 5.743c.159 1.031.375 2.064.651 3.096a138.813 138.813 0 0 1 4.037 21.988 136.805 136.805 0 0 1-.851 34.281m-2.99 14.436a137.594 137.594 0 0 0 1.96-8.525m-7.342 6.399a131.369 131.369 0 0 0 4.034-26.797m.139-5.983a131.735 131.735 0 0 0-2.297-24.507m-1.321-6.187a134.633 134.633 0 0 0-.916-3.619c-3.884-14.493 2.075-29.305 13.779-37.338m5.164-2.92a34.694 34.694 0 0 1 5.424-1.947c10.383-2.783 20.93-.513 29.031 5.302m4.594 3.951a34.304 34.304 0 0 1 8.58 15.114 203.072 203.072 0 0 1 4.982 24.53m-.568 59.018c.351-2.206.666-4.422.944-6.645m.675-6.175a199.627 199.627 0 0 0-.35-40.588m5.096 49.622a205.025 205.025 0 0 0 1.856-25.62m-.036-6.301a206.181 206.181 0 0 0-3.301-32.643m-1.199-6.07a210.787 210.787 0 0 0-2.551-10.615c-3.048-11.376-10.683-20.3-20.381-25.313m-5.427-2.32a40.017 40.017 0 0 0-23.432-.795 40.017 40.017 0 0 0-18.527 10.91m-3.839 4.633c-6.692 9.428-9.288 21.656-6.062 33.697a127.686 127.686 0 0 1 2.958 14.221m-2.276 48.624a125.82 125.82 0 0 0 2.413-12.458m.724-6.221c.716-7.858.698-15.856-.108-23.904m-8.201 39.509a119.803 119.803 0 0 0 3.073-28.472m-.236-6.18a121.183 121.183 0 0 0-3.895-23.633 45.799 45.799 0 0 1-1.11-18.433m1.23-5.817c3.987-14.227 14.743-26.185 29.553-31.173m5.405-1.466c11.4-2.368 22.8-.262 32.265 5.198m21.028 26.526c.137.456.268.917.393 1.38a214.183 214.183 0 0 1 6.052 32.272m-22.488-56.854a45.73 45.73 0 0 1 13.92 17.527m8.543 85.266c.427-3.88.748-7.783.96-11.703m.242-6.16a211.05 211.05 0 0 0-.592-21.841m5.676 34.304c.674-8.225.881-16.534.603-24.895m-.29-6.109a218.734 218.734 0 0 0-4.978-34.788m-1.482-6.143c-.201-.788-.408-1.575-.619-2.362-2.179-8.132-6.18-15.29-11.448-21.15M90.527 30.49a51.904 51.904 0 0 1 25.525 12.125M84.404 29.832a51.662 51.662 0 0 0-15.82 1.717 51.636 51.636 0 0 0-15.187 6.832M30.393 85.143a51.961 51.961 0 0 0 1.64 9.715 116.44 116.44 0 0 1 1.869 8.121m-3.583-24.014c.694-14.315 7.356-27.672 18.131-36.857M33.57 147.96c.367-1.761.694-3.534.978-5.316m.765-5.705c1-9.232.884-18.692-.452-28.197m-6.31 34.914c.704-3.947 1.191-7.949 1.453-11.991m.224-6.148a109.232 109.232 0 0 0-3.742-29.173c-.212-.79-.406-1.58-.583-2.37m-1-5.876c-2.766-23.598 9.421-46.417 30.17-57.384m5.275-2.453a58.011 58.011 0 0 1 6.75-2.26c23.176-6.21 46.841 2.682 60.548 20.643m3.272 4.771a57.439 57.439 0 0 1 6.522 15.199 226.796 226.796 0 0 1 4.515 20.642m2.893 48.577c.09-1.799.158-3.601.205-5.407m.073-5.965a222.877 222.877 0 0 0-2.276-31.5m8.008 34.423c.083-7.127-.168-14.3-.765-21.498m-.586-6.086a231.493 231.493 0 0 0-6.519-34.673c-3.582-13.366-11.192-24.578-21.174-32.678M75.746 18.6c14.883-1.49 29.429 2.407 41.336 10.361m-47.481-9.44c-1.33.267-2.66.578-3.99.934C50.485 24.507 38.12 33.72 29.9 45.69m-3.255 5.273c-7.613 13.798-10.107 30.444-5.706 46.868a104.264 104.264 0 0 1 2.779 14.269m-.184 26.509a102.608 102.608 0 0 0 .75-20.418m-5.864 14.356c.125-1.521.213-3.048.266-4.581m.006-6.463a97.93 97.93 0 0 0-3.3-22.186c-2.685-10.016-3.018-20.11-1.339-29.692m1.326-5.98c5.69-21.168 21.346-39.086 43.035-46.943m5.712-1.796c13.88-3.719 27.908-2.924 40.522 1.485m5.592 2.232c15.281 6.885 27.959 19.27 34.935 35.364m2.164 5.664c.436 1.31.836 2.64 1.198 3.99a237.984 237.984 0 0 1 5.55 26.756m2.402 26.56a234.352 234.352 0 0 0-1.589-20.534m2.05-22.401a244.684 244.684 0 0 0-2.866-11.868 74.53 74.53 0 0 0-10.755-23.244m17.967 63.232a241.434 241.434 0 0 0-3.148-22.198M95.197 7.98a74.953 74.953 0 0 1 44.722 26.398M89.177 7.142A74.503 74.503 0 0 0 62.638 9.36a74.642 74.642 0 0 0-20.558 8.976M7.34 84.425a74.923 74.923 0 0 0 2.503 16.379 93.213 93.213 0 0 1 1.372 5.875M7.324 78.884c.779-22.635 11.898-43.711 29.862-57.178m-24.19 102.515a91.46 91.46 0 0 0-.77-11.421M2.543 94.09a79.98 79.98 0 0 1 4.463-41.73m2.404-5.55c7.246-15.146 19.178-27.966 34.472-36.17m5.521-2.695a81.02 81.02 0 0 1 11.748-4.134c19.677-5.273 39.606-2.77 56.524 5.625m5.199 2.822a80.738 80.738 0 0 1 11.5 8.232m28.006 51.482a250.087 250.087 0 0 0-2.602-10.75m-21.058-36.718a79.929 79.929 0 0 1 19.414 31.213"
            stroke="#385056"
            strokeWidth="2"
            strokeLinecap="round"
          />
          <Box
            component={motion.path}
            d="M78.99 70.384c6.128-1.642 12.427 1.994 14.068 8.122a179.609 179.609 0 0 1 4.733 24.151m-91.563 8.777a87.148 87.148 0 0 0-1.933-9.144 82.29 82.29 0 0 1-.597-2.367m80.861-7.248a169.016 169.016 0 0 0-2.596-11.196m.737 83.493a166.01 166.01 0 0 0 2.082-9.463m1.014-5.935a165.476 165.476 0 0 0-.156-50.796m3.04 65.929a171.42 171.42 0 0 0 3.707-21.21m-4.51-62.116c-.12-.463-.242-.926-.366-1.388a5.743 5.743 0 0 0-11.096 2.973 161.908 161.908 0 0 1 4.794 26.513m11.731 28.073c1.251-16.583.101-33.598-3.713-50.587m-12.402 77.797a159.741 159.741 0 0 0 4.842-49.311m-10.6 48.624c.515-1.949.993-3.911 1.433-5.884m1.108-5.434a153.991 153.991 0 0 0 1.272-48.123m-.905-6a157.03 157.03 0 0 0-3.107-14.182 11.48 11.48 0 0 1 2.778-10.899m21.083 90.519a177.255 177.255 0 0 0 2.664-14.383m.73-5.796a176.735 176.735 0 0 0 .323-35.168m2.452 54.046a182.553 182.553 0 0 0 3.914-31.968m.102-6.27c-.014-15.691-2.054-31.638-6.308-47.514a17.15 17.15 0 0 0-5.496-8.68M88.3 65.455a17.153 17.153 0 0 0-10.797-.62c-8.725 2.338-14.083 10.969-12.499 19.7m.386 78.533a148.503 148.503 0 0 0 4.893-31.487m.16-6.137a149.259 149.259 0 0 0-4.101-35.47m-6.501 71.608a143.02 143.02 0 0 0 3.746-19.139m.648-6.268c1.292-15.957-.083-32.402-4.464-48.751a22.867 22.867 0 0 1 .398-13.226m2.799-5.644a22.884 22.884 0 0 1 13.048-9.267c9.08-2.433 18.346.928 23.875 7.817m3.004 4.9a23.16 23.16 0 0 1 1.258 3.528 192.094 192.094 0 0 1 3.225 14.15m-.275 71.426c.215-1.094.421-2.189.617-3.288m1.027-6.369a188.324 188.324 0 0 0-.342-55.801m4.97 63.182a193.99 193.99 0 0 0 1.976-13.956m-5.176-69.025c-.155-.602-.313-1.204-.474-1.806-2.261-8.436-8.053-14.984-15.359-18.48m21.556 83.118c1.351-18.682.014-37.84-4.305-56.969M88.679 53.553a28.59 28.59 0 0 0-14.148.187c-12.36 3.312-20.667 14.203-21.258 26.333m.3 5.743c.159 1.031.375 2.064.651 3.096a138.813 138.813 0 0 1 4.037 21.988 136.805 136.805 0 0 1-.851 34.281m-2.99 14.436a137.594 137.594 0 0 0 1.96-8.525m-7.342 6.399a131.369 131.369 0 0 0 4.034-26.797m.139-5.983a131.735 131.735 0 0 0-2.297-24.507m-1.321-6.187a134.633 134.633 0 0 0-.916-3.619c-3.884-14.493 2.075-29.305 13.779-37.338m5.164-2.92a34.694 34.694 0 0 1 5.424-1.947c10.383-2.783 20.93-.513 29.031 5.302m4.594 3.951a34.304 34.304 0 0 1 8.58 15.114 203.072 203.072 0 0 1 4.982 24.53m-.568 59.018c.351-2.206.666-4.422.944-6.645m.675-6.175a199.627 199.627 0 0 0-.35-40.588m5.096 49.622a205.025 205.025 0 0 0 1.856-25.62m-.036-6.301a206.181 206.181 0 0 0-3.301-32.643m-1.199-6.07a210.787 210.787 0 0 0-2.551-10.615c-3.048-11.376-10.683-20.3-20.381-25.313m-5.427-2.32a40.017 40.017 0 0 0-23.432-.795 40.017 40.017 0 0 0-18.527 10.91m-3.839 4.633c-6.692 9.428-9.288 21.656-6.062 33.697a127.686 127.686 0 0 1 2.958 14.221m-2.276 48.624a125.82 125.82 0 0 0 2.413-12.458m.724-6.221c.716-7.858.698-15.856-.108-23.904m-8.201 39.509a119.803 119.803 0 0 0 3.073-28.472m-.236-6.18a121.183 121.183 0 0 0-3.895-23.633 45.799 45.799 0 0 1-1.11-18.433m1.23-5.817c3.987-14.227 14.743-26.185 29.553-31.173m5.405-1.466c11.4-2.368 22.8-.262 32.265 5.198m21.028 26.526c.137.456.268.917.393 1.38a214.183 214.183 0 0 1 6.052 32.272m-22.488-56.854a45.73 45.73 0 0 1 13.92 17.527m8.543 85.266c.427-3.88.748-7.783.96-11.703m.242-6.16a211.05 211.05 0 0 0-.592-21.841m5.676 34.304c.674-8.225.881-16.534.603-24.895m-.29-6.109a218.734 218.734 0 0 0-4.978-34.788m-1.482-6.143c-.201-.788-.408-1.575-.619-2.362-2.179-8.132-6.18-15.29-11.448-21.15M90.527 30.49a51.904 51.904 0 0 1 25.525 12.125M84.404 29.832a51.662 51.662 0 0 0-15.82 1.717 51.636 51.636 0 0 0-15.187 6.832M30.393 85.143a51.961 51.961 0 0 0 1.64 9.715 116.44 116.44 0 0 1 1.869 8.121m-3.583-24.014c.694-14.315 7.356-27.672 18.131-36.857M33.57 147.96c.367-1.761.694-3.534.978-5.316m.765-5.705c1-9.232.884-18.692-.452-28.197m-6.31 34.914c.704-3.947 1.191-7.949 1.453-11.991m.224-6.148a109.232 109.232 0 0 0-3.742-29.173c-.212-.79-.406-1.58-.583-2.37m-1-5.876c-2.766-23.598 9.421-46.417 30.17-57.384m5.275-2.453a58.011 58.011 0 0 1 6.75-2.26c23.176-6.21 46.841 2.682 60.548 20.643m3.272 4.771a57.439 57.439 0 0 1 6.522 15.199 226.796 226.796 0 0 1 4.515 20.642m2.893 48.577c.09-1.799.158-3.601.205-5.407m.073-5.965a222.877 222.877 0 0 0-2.276-31.5m8.008 34.423c.083-7.127-.168-14.3-.765-21.498m-.586-6.086a231.493 231.493 0 0 0-6.519-34.673c-3.582-13.366-11.192-24.578-21.174-32.678M75.746 18.6c14.883-1.49 29.429 2.407 41.336 10.361m-47.481-9.44c-1.33.267-2.66.578-3.99.934C50.485 24.507 38.12 33.72 29.9 45.69m-3.255 5.273c-7.613 13.798-10.107 30.444-5.706 46.868a104.264 104.264 0 0 1 2.779 14.269m-.184 26.509a102.608 102.608 0 0 0 .75-20.418m-5.864 14.356c.125-1.521.213-3.048.266-4.581m.006-6.463a97.93 97.93 0 0 0-3.3-22.186c-2.685-10.016-3.018-20.11-1.339-29.692m1.326-5.98c5.69-21.168 21.346-39.086 43.035-46.943m5.712-1.796c13.88-3.719 27.908-2.924 40.522 1.485m5.592 2.232c15.281 6.885 27.959 19.27 34.935 35.364m2.164 5.664c.436 1.31.836 2.64 1.198 3.99a237.984 237.984 0 0 1 5.55 26.756m2.402 26.56a234.352 234.352 0 0 0-1.589-20.534m2.05-22.401a244.684 244.684 0 0 0-2.866-11.868 74.53 74.53 0 0 0-10.755-23.244m17.967 63.232a241.434 241.434 0 0 0-3.148-22.198M95.197 7.98a74.953 74.953 0 0 1 44.722 26.398M89.177 7.142A74.503 74.503 0 0 0 62.638 9.36a74.642 74.642 0 0 0-20.558 8.976M7.34 84.425a74.923 74.923 0 0 0 2.503 16.379 93.213 93.213 0 0 1 1.372 5.875M7.324 78.884c.779-22.635 11.898-43.711 29.862-57.178m-24.19 102.515a91.46 91.46 0 0 0-.77-11.421M2.543 94.09a79.98 79.98 0 0 1 4.463-41.73m2.404-5.55c7.246-15.146 19.178-27.966 34.472-36.17m5.521-2.695a81.02 81.02 0 0 1 11.748-4.134c19.677-5.273 39.606-2.77 56.524 5.625m5.199 2.822a80.738 80.738 0 0 1 11.5 8.232m28.006 51.482a250.087 250.087 0 0 0-2.602-10.75m-21.058-36.718a79.929 79.929 0 0 1 19.414 31.213"
            stroke="#46dbf9"
            strokeWidth="2"
            strokeLinecap="round"
            strokeDasharray="80 80"
            strokeDashoffset={pathLength}
          />
        </Box>
        <Box
          sx={{
            position: 'absolute',
            borderRadius: 'inherit',
            boxShadow:
              '0 0 30px rgba(70, 219, 249,0.4),0 0 100px rgba(72, 185, 208, 0.5)',

            background:
              'radial-gradient(50% 50% at 50% 50%,rgba(0,0,0,0) 85%,rgba(81, 147, 160,.18) 96%,hsla(0,0%,100%,.8) 98%,rgba(70, 219, 249,.2) 100%),rgba(70, 219, 249,.15)',
            top: 0,
            left: 0,
            width: '100%',
            height: '100%',
            pointerEvents: 'none',
          }}
        />
      </Box>
    </Box>
  );
};

export default FingerprintScan;
